<html lang="ru" xml:lang="ru"><head>
<META http-equiv="Content-Type" content="text/html">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><META name="description" content="Сайт может содержать множество компьютеров ArcGIS Server, чтобы помочь в обработке увеличившегося потока данных или предоставить резервную мощность в случае, если один из компьютеров становится недоступным."><meta name="content-language" content="ru"><link href="rsrc/htmlhelp.css" rel="stylesheet" type="text/css"><title>ArcGIS - 
Развертывание на нескольких серверах с балансировщиком нагрузки стороннего разработчика</title>
                <script type="text/javascript" language="JavaScript">
                    var pathL  = self.location.pathname.split ("/");
                    var fname = pathL[pathL.length-1];
                    var i = fname.lastIndexOf (".htm");
                    if (i>=0) {
                    fname = fname.substring (0, i)
                    } else {
                    //??
                    }
                    if (self.location.hash) {
				    		      fname = fname + self.location.hash;
						        }
                    self.location.replace ("../index.html#//" + fname);
                </script>
                </head><!--Publication GUID: [GUID-FB5257BE-DC53-48C6-82F8-1DA075B0A617]--><!--Topic GUID: [GUID-08196164-3CAB-4F08-9C3E-C5BC43FF8C23]--><body><div id="content"><div class="header"><h1>
Развертывание на нескольких серверах с балансировщиком нагрузки стороннего разработчика</h1><div id="breadcrumb"></div></div>
<p id="GUID-7D1F5381-6018-4B2E-A173-E6FB8DB627C3"> <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> поддерживает настройку сайтов на нескольких компьютерах. На сайте с несколькими компьютерами можно управлять двумя или более серверами, и использовать их, как отдельную логическую единицу, что предоставляет администраторам <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> гибкость для легкой настройки вычислительной мощности сайта путем добавления или удаления компьютеров. Сайты на нескольких компьютерах также упрощают процесс публикации и обновления сервисов между несколькими компьютерами <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>.</p><p id="GUID-FA3F35BB-BE81-4D99-8507-6ED393B11F72">При развертывании на нескольких компьютерах, каждый компьютер <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> должен иметь один и тот же номер версии для корректной работы сайта.  Дополнительно, точно такая же лицензия должна применяться к каждому компьютеру, который участвует в сайте.</p><p id="GUID-7AA1BAD4-6DA4-4960-BFE4-38FCDA2633B2"> Обычная конфигурация на нескольких компьютерах включает в себя прокси-сервер стороннего разработчика или балансировщик сетевой нагрузки, находящиеся перед пулом компьютеров <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>.</p><div class="image" purpose="image"><table><tr><td><img class="break" src="01n1/GUID-D4C995D9-D217-43B5-8405-C6865551E641-web.png" purpose="img" alt="Сайт с несколькими компьютерами" title="Сайт с несколькими компьютерами"></td></tr><tr><td><div class="caption" purpose="caption">Сайт с несколькими компьютерами <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> и балансировщиком загрузки</div></td></tr></table></div><p id="GUID-7813AE69-5DA1-4ABF-B26A-8430294C93FD"> Ключевым аспектом конфигураций с несколькими компьютерами является то, что все компьютеры <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> имеют общий доступ к хранилищу конфигурации и директориям сервера. Таким образом, с помощью <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> Manager администратор может подключиться к любому компьютеру и применить изменения, которые будут применены ко всем компьютерам сайта.</p><div class="section1" id="ESRI_SECTION1_14CC6AE269D74871B7D81EC84AB5DF75" purpose="section1"><h2>Компьютеры <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>, директории сервера и хранилище конфигураций</h2><p id="GUID-33B1D0C7-B9C5-44FB-A84C-3F395C5C1167">Поскольку все компьютеры <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> в конфигурациях с несколькими компьютерами имеют общее хранилище конфигураций и директории сервера, вам необходимо выбрать местоположение в сети для ваших директорий сервера и хранилища конфигураций.</p><p id="GUID-7AE3C15F-3E83-4E7A-B412-95BBB3274DE7"> Как правило, для учетной записи <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> выбирается доменная учетная запись, так как это упрощает управление правами доступа к данным сетевых ресурсов. Но в зависимости от вашей политики безопасности, вы можете использовать локальные учетные записи. Учетная запись <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> (локальная или доменная) должна иметь права доступа к сетевой папке, где находятся хранилище конфигураций и директории сервера. Более подробно см. в <a class="xref" target="_blank" rel="http://server.arcgis.com/ru/server/latest/administer/windows/accounts-used-by-arcgis-server.htm" href="http://server.arcgis.com/ru/server/latest/administer/windows/accounts-used-by-arcgis-server.htm">Учетные записи, используемые в ArcGIS Server</a>.</p><p id="GUID-93BA97C6-C3B8-40B1-B630-D7515B596705">Для сайта из нескольких компьютеров, все
компьютеры <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> изначально принадлежат к одному <a class="xref" target="_blank" rel="http://server.arcgis.com/ru/server/latest/administer/windows/about-gis-server-clusters.htm" href="http://server.arcgis.com/ru/server/latest/administer/windows/about-gis-server-clusters.htm">кластеру</a> с использованием порта 4004 и выше. В версии 10.4 новые установки <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> по умолчанию используют <a class="xref" target="_blank" rel="http://server.arcgis.com/ru/server/latest/administer/windows/about-single-cluster-mode.htm" href="http://server.arcgis.com/ru/server/latest/administer/windows/about-single-cluster-mode.htm">режим одного кластера</a>. Этот режим не включает функции балансировки нагрузки между компьютерами кластера. Это сокращает сетевой трафик между компьютерами сайта, уменьшает нагрузку на сеть и способствует улучшению мониторинга компьютеров <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> на сайте. При обновлении с устаревших версий до версии 10.4 или выше этот режим включается для сайтов с одним кластером, которые в данный момент не используют режим одного кластера. Все настройки тех сайтов с одним кластером, которые используют режим одного кластера, и сайтов из нескольких кластеров более старых версий будут защищены от обновления.</p><p id="GUID-91E9E50C-6209-4D73-8EBD-86870C1C743A"> Если на сайте используется несколько кластеров, балансировка нагрузки происходит среди всех компьютеров <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> каждого кластера. По существу, кластеры – это независимые группы компьютеров, на которых обрабатываются свои выделенные наборы сервисов.</p><p id="GUID-34659E5E-FAAD-4401-9537-A5F1AC6E06A5">Например, входящий запрос назначается доступному компьютеру <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> в кластере, даже если запрос был направлен к определенному компьютеру внутри или вне этого кластера. Компьютер, выполняющий отрисовку карты, поиск адреса, запускающий инструмент геообработки и т. д. возвращает результаты клиенту. Если компьютер отключен или запрашиваемый сервис работает на другом кластере, запрос перенаправляется на кластер, где находится сервис. Компьютеры <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> в этом кластере распределяют нагрузку и соответственно обрабатывают запросы.</p></div><div class="section1" id="ESRI_SECTION1_68CB0DD2AAD84B5797E32AD99C6F8A19" purpose="section1"><h2>Данные</h2><p id="GUID-683DCBD4-1E50-44E4-BE33-D0952AA667B5"> Как уже было показано в других сценариях развертывания, при использовании файловых данных настоятельно рекомендуется использовать локальные ресурсы для компьютера <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>. Несмотря на неудобство, заключающееся в том, что вы вынуждены копировать свои данные на все компьютеры, это уменьшает сетевой трафик и способствует увеличению производительности ваших сервисов. Необходимо иметь в виду этот вариант и использовать его, когда это возможно. Хранение данных локально на жестких дисках компьютеров обычно обосновывается размером этих данных и частотой их обновления.</p><p id="GUID-C00F3955-D0D0-4E89-BF84-6AEFAC472A15"> При такой схеме развертывания для пользования базами данных важно, чтобы у вас всегда было соответствующее аппаратное обеспечение. Держите уровень баз данных отдельно от уровня <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>.</p></div><div class="section1" id="ESRI_SECTION1_C0B4AA3B947E494CAF38E2D06896D1C7" purpose="section1"><h2>Обратный прокси-сервер стороннего разработчика или балансировщик сетевой нагрузки</h2><p id="GUID-59009666-37AB-4677-8DA2-E984B444C86F"> В этой конфигурации клиенты <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> никогда не подключаются к вашим компьютерам <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> напрямую. Вместо этого они подключаются через некое среднее звено, которое выполняет функцию защиты и делает весь ваш сайт более устойчивым к сбоям.</p><p id="GUID-0E9F0A14-AFE9-4891-9680-43EED7082B90"> С точки зрения безопасности не рекомендуется использовать один и тот же канал и для использования, и для администрирования сайта. Как правило, административные задачи работают только в частях вашей сети или на отдельных компьютерах, непосредственно обращающихся к вашим компьютерам <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>, например, через порт 6080 или 6443. Это можно обойти, задав доступ к Administrator Directory сервера только с определенных IP-адресов.  За это отвечает свойство <span class="usertext">allowedAdminAccessIPs</span> в <a class="xref" target="_blank" rel="http://resources.arcgis.com/ru/help/arcgis-rest-api/02r3/02r3000001t9000000.htm" href="http://resources.arcgis.com/ru/help/arcgis-rest-api/02r3/02r3000001t9000000.htm">параметрах безопасности сервера</a>.  О настройке этого параметра для ограничения доступа к серверу см. пример в разделе <a class="xref" target="_blank" rel="http://resources.arcgis.com/ru/help/arcgis-rest-api/02r3/02r3000001rw000000.htm" href="http://resources.arcgis.com/ru/help/arcgis-rest-api/02r3/02r3000001rw000000.htm">Обновление конфигурации безопасности</a>.</p><p id="GUID-4D28AF6E-A555-4822-8C1B-D7DF5D01FF34"> Запросы от клиентских приложений всегда направляются через обратный прокси, который предотвращает использование любых конечных точек администратора. Большинство прокси-серверов сторонних разработчиков позволяют отфильтровывать входящие запросы, содержащие URL определенного формата. Блокируя входящие запросы, использующие ресурсы <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> Administrator Directory (<span class="usertext">http://gisserver.domain.com:6080/arcgis/admin</span>) или <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> Manager (<span class="usertext">http://gisserver.domain.com:6080/arcgis/manager</span>), обратный прокси надежно блокирует любые административные задачи.</p><p id="GUID-6DC6A4F1-EF76-410B-A352-EBDFE31293F0"> Обратный прокси также служит как балансировщик нагрузки для сайта. Для этой конфигурации подходит простейший алгоритм балансировки нагрузки – круговой.</p><p id="GUID-B9492F73-C386-4405-A524-9A134106B74D">Если вы используете балансировщики загрузки с функцией проверки работоспособности, рекомендуем вам использовать точку доступа проверки работоспособности <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>, чтобы определить, сможет ли сайт получать запросы.  Это используется, чтобы быстро определить, нет ли на сайте аппаратного или программного сбоя.  Дополнительные сведения см. в разделе <a class="xref" target="_blank" rel="http://resources.arcgis.com/ru/help/arcgis-rest-api/02r3/02r3000002n7000000.htm" href="http://resources.arcgis.com/ru/help/arcgis-rest-api/02r3/02r3000002n7000000.htm">Проверка работоспособности</a> в ArcGIS REST API.</p><p id="GUID-28E2F286-E703-4DAA-95BA-016946315B13">Для изучения вопросов интеграции обратного прокси-сервера с <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> см. раздел <a class="xref" target="_blank" rel="http://server.arcgis.com/ru/server/latest/administer/windows/using-a-reverse-proxy-server-with-arcgis-server.htm" href="http://server.arcgis.com/ru/server/latest/administer/windows/using-a-reverse-proxy-server-with-arcgis-server.htm">Использование обратного прокси-сервера с ArcGIS Server</a>.</p></div><div class="section1" id="ESRI_SECTION1_7D80FDD6984A4CB89673169EC202AE9B" purpose="section1"><h2>Достоинства</h2><ul purpose="ul" id="UL_95A679B9F76D4BF689C7D662788FF04D"><li purpose="li" id="LI_282DE4C9AD6B4A4988654E435162F3EB">Один отдельный сайт <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> располагает средствами, которые позволяют с легкостью администрировать <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> и его сервисы на множестве компьютеров.</li><li purpose="li" id="LI_27251CF49540483AB4F13EA8C01AE620"> Производительность сайта легко регулируется добавлением или удалением компьютеров <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>.</li><li purpose="li" id="LI_771CF22F97D84BABBF6A2695DEBED2F2">Балансировка нагрузки выполняется между компьютерами <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>.</li></ul></div>
<div class="section1" id="ESRI_SECTION1_41EFAD1B165B4AD7BB2360CACBFE3F46" purpose="section1"><h2>Недостатки</h2><ul purpose="ul" id="UL_990D447AD1774E3BB15F91EC33862342"><li purpose="li" id="LI_A1774AA02A234F6B99B66A5C3C260121">Использование директорий и данных <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> в общедоступных местоположениях в сети может оказать негативное влияние на производительность сервисов с высокой нагрузкой.</li><li purpose="li" id="LI_8E200906EA23425EAD7C18CEB73610F3">Необходимы знания о балансировщиках загрузки сторонних разработчиков.</li><li purpose="li" id="LI_6F2309574D9A4365BB40ED27E5601F24">Не поддерживает аутентификацию на веб-уровне. Для использования аутентификации на веб-уровне см. раздел <a class="xref" rel="01n1/01n10000002t000000.htm" href="01n1/01n10000002t000000.htm">Развертывание на нескольких компьютерах с ArcGIS Web Adaptor</a>.</li></ul></div><div class="footer"> Copyright © 1995-2017 Esri. All rights reserved. </div></div></body></html>