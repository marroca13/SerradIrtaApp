<html lang="ja" xml:lang="ja"><head>
<META http-equiv="Content-Type" content="text/html">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><META name="description" content="ArcGIS Server 層の単一障害点をなくすために、単一コンピューターの ArcGIS Server サイトをフェイルオーバー方式で構成し、サードパーティ製のロード バランサーを組み入れることができます。"><meta name="content-language" content="ja"><link href="rsrc/htmlhelp.css" rel="stylesheet" type="text/css"><title>ArcGIS - 
単一コンピューターの高可用性配置 (アクティブ/パッシブ)</title>
                <script type="text/javascript" language="JavaScript">
                    var pathL  = self.location.pathname.split ("/");
                    var fname = pathL[pathL.length-1];
                    var i = fname.lastIndexOf (".htm");
                    if (i>=0) {
                    fname = fname.substring (0, i)
                    } else {
                    //??
                    }
                    if (self.location.hash) {
				    		      fname = fname + self.location.hash;
						        }
                    self.location.replace ("../index.html#//" + fname);
                </script>
                </head><!--Publication GUID: [GUID-FB5257BE-DC53-48C6-82F8-1DA075B0A617]--><!--Topic GUID: [GUID-5BAC2F6A-272F-46A1-B7C1-2051320339BA]--><body><div id="content"><div class="header"><h1>
単一コンピューターの高可用性配置 (アクティブ/パッシブ)</h1><div id="breadcrumb"></div></div>
<p id="GUID-36F9A1B2-A480-4256-8D70-EDA6F9381933"> <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 層の単一障害点をなくすために、単一コンピューターの <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> サイトをフェイルオーバー方式で構成し、サードパーティ製のロード バランサーを組み入れることができます。</p><p id="GUID-530A2A53-6D12-423C-A75F-A29D9D8EB644"> 概説すると、この配置パターンの概念は、単一コンピューターのサイトのクローンを作成して、そのサイトの独立した 2 つ以上のインスタンスを、アクティブ/パッシブ構成を備えたロード バランサーの内側に配置するというものです。ロード バランサーの内側にあるすべてのサイトが稼働中で、サービス リクエストをいつでも受け付けることができる間、ロード バランサーは、サイトの中でプライマリ サイトとして指定されているサイトにのみリクエストを渡します。プライマリサイトが使用不可であることをロード バランサーが検出した場合、受信したリクエストは、フェイルオーバーまたはスタンバイ サイトにリダイレクトされます。</p><div class="image" purpose="image"><table><tr><td><img class="break" src="01n1/GUID-5C90B73D-37F7-49B6-BA71-C78FE2A76D5D-web.png" purpose="img" alt="スタンバイ サイトが存在する、可用性の高い単一コンピューターの配置" title="スタンバイ サイトが存在する、可用性の高い単一コンピューターの配置"></td></tr><tr><td><div class="caption" purpose="caption">スタンバイ サイトが存在する、可用性の高い単一コンピューターの配置。管理者は各サイトに個別に接続します。いずれのサイトにも、サーバー ディレクトリと構成ストアの同じコピーがあります。</div></td></tr></table></div><p id="GUID-B2F53AB0-20AB-4A1A-87B9-2DE1B681002F"> フェイルオーバー プロセスは <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> の外部で完全に処理されます。通常、このプロセスは、<span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> コンピューターが完全に使用不可である場合 (ネットワークまたはハードウェアの障害)、または時として、特定の GIS サービスまたは操作が失敗した場合に起動されるように構成できます。</p><div class="notes" id="GUID-4AB84509-E900-4BAA-BF8A-1795C5996A5F"><div class="note"><img class="note_img" src="rsrc/note.png" alt="備考" title="注意"><span>注意:</span></div><div class="tipbody"><p id="GUID-E7204827-F79D-4C0A-BCB5-465EBCEC4760">追加コストなしで、スタンバイまたはフェイルオーバー サイトのためのライセンス ファイルを <span purpose="ph" varid="myesrilink"><a target="_blank" class="xref" href="https://my.esri.com/" rel="https://my.esri.com/">My Esri</a></span> に要求することができます。</p></div></div><p id="GUID-582734D0-2474-450E-BA4C-513D2701FE6B"> この配置パターンにおいて <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> をホストするために複数台のコンピューターが使用されている間、この構成は技術的には複数コンピューターのサイトと呼ぶことはできません。その理由は、ロード バランサーの内側にあるそれぞれのサイトが互いに独立しているからです。それぞれのサイトは 1 台の <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> コンピューターから構成され、独自の構成ストアとサーバー ディレクトリを備えています。</p>
<div class="section1" id="ESRI_SECTION1_6855783BE1014AAF8C9BAAA490966934" purpose="section1"><h2><span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> コンピューター、サーバー ディレクトリ、および構成ストア</h2><p id="GUID-14FA6DC6-BCD6-4225-ABE4-05DAC4AE0791"> この場合、「<a class="xref" rel="01n1/01n10000002w000000.htm" href="01n1/01n10000002w000000.htm">単一コンピューターの配置</a>」に記載されたものと同じ懸念事項が適用されます。<span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> は、それぞれが独自のサーバー ディレクトリと構成ストアをローカルに保持しています。これにより、最大限のパフォーマンスが保証され、相互依存性を最小限に維持できます。</p></div><div class="section1" id="ESRI_SECTION1_BF1EDC0004BA41DC802401E547D314D9" purpose="section1"><h2>データ</h2><p id="GUID-7FF07C0D-DB56-421E-AEF9-68C62417A2CA"> GIS サービスでファイルベースのデータ ソースを使用する場合は、サービスのパフォーマンスを最大化するために、これらのデータ ソースを、ネットワーク共有ではなく <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> コンピューターごとにローカルに保存することをお勧めします。大量の画像を処理する場合など、ネットワーク上でファイルを共有するしか現実的な方法がない場合があります。ネットワーク上で共有されたリソースのファイルを使用する場合、高可用性向けに構成されたストレージ デバイスを選択することが極めて重要です。</p><p id="GUID-FC892FD0-09B5-4A0E-AA48-03C3FF722C81">データベースを使用する場合は、それぞれのサイトに 1 つのデータベースを割り当てることができます (プライマリ サイトに 1 つとスタンバイ サイトに 1 つのデータベース)。データベースを同期した状態に保つために、データベース レプリケーション、または必要に応じてジオデータベース レプリケーション手法を利用できます。あるいは、データベース プロバイダーから提供された他の高可用性技術を利用できます。</p></div><div class="section1" id="ESRI_SECTION1_E28679F50AC74EA885D013361DC0F1E5" purpose="section1"><h2>リバース プロキシ サーバー</h2><p id="GUID-9605B5A1-A4C5-4E7B-80F0-F58070FF4D82"> この構成では、サードパーティ製のロード バランサーが必要です。少なくとも、サイト間で負荷を処理するためや必要に応じてフェイルオーバーを実施するためにこのコンポーネントが使用されます。通常、ロード バランサーが、リバース プロキシ サーバーの役割も果たします (「<a class="xref" rel="01n1/01n10000002r000000.htm" href="01n1/01n10000002r000000.htm">リバース プロキシ サーバーを使用した単一コンピューターの配置</a>」を参照)。場合によっては、すでに<a class="xref" target="_blank" rel="http://server.arcgis.com/ja/server/latest/administer/windows/using-a-reverse-proxy-server-with-arcgis-server.htm" href="http://server.arcgis.com/ja/server/latest/administer/windows/using-a-reverse-proxy-server-with-arcgis-server.htm">リバース プロキシ サーバー</a>をロード バランサーから独立して構成している場合があります。</p><p id="GUID-C09E8E7A-2E5A-4CA2-9C60-6AA77BD53977">ネットワーク ロード バランサーが状態チェック機能に対応している場合は、<span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> の状態チェック エンドポイントを使用して、サイトがリクエストを受け取れるかどうかを確認できます。これは、サイトでソフトウェアまたはハードウェアの障害があるかどうかを迅速に確認する場合に便利です。詳細については、ArcGIS REST API の「<a class="xref" target="_blank" rel="http://resources.arcgis.com/ja/help/arcgis-rest-api/02r3/02r3000002n7000000.htm" href="http://resources.arcgis.com/ja/help/arcgis-rest-api/02r3/02r3000002n7000000.htm">状態チェック</a>」をご参照ください。</p><p id="GUID-4F6CC4E8-8356-43C3-B384-011F5711C6D7"> ArcGIS Web Adaptor の使用はオプションであり、通常、このシナリオで Web 層認証を利用したい場合にのみ必要になります。操作の簡略化を図るために、ArcGIS Web Adaptor を <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> と同じコンピューターに構成できます。あるいは、ArcGIS Web Adaptor を専用のコンピューターに構成することもできます。いずれの場合も、ArcGIS Web Adaptor を使用する場合は、サイトごとに個別の ArcGIS Web Adaptor を構成する必要があります。</p></div><div class="section1" id="ESRI_SECTION1_196562782F0149D9A8D7862BA38841EB" purpose="section1"><h2>その他の考慮事項</h2><div class="section2" id="ESRI_SECTION2_C0955A61BFD348F68136E7289F25B83B" purpose="section2"><h3>サイトでのサービスの同期状態の維持</h3><p id="GUID-236BE866-44C2-4547-A913-EFAC3C3B4888"> 実際の複数コンピューターのサイトとは異なり、この構成では、ロード バランサーの内側にあるすべてのサイトがまったく同じコンテンツをホストし、同じセキュリティ モデルに従う必要があります。管理者は、ロード バランサーから見て、すべてのサイトがまったく同じになるようにする必要があります。</p><p id="GUID-8F3DE45D-6ADC-4E02-9070-DB09850AFCC8"> プライマリ サイトとフェイルオーバー サイト間で <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> サービスの同期を維持するために役立つ方法がいくつかあります。</p><ul purpose="ul" id="UL_F4A876F72DBB46A397A69054C851CD96"><li purpose="li" id="LI_2402FD84A05D4D2695366E4E4B018FF4">スクリプト: <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> は、管理タスク (サービスの公開やサービスのセキュリティ設定の変更など) のスクリプトの作成に使用できる REST ベースの管理用 API を備えています。ユーザーは独自のスクリプトを作成して、配置に関係するすべての <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> に一貫して変更を適用することができます。スクリプトは、サービスのセキュリティの変更や上書きなど、微調整を行う必要がある場合に特に便利です。詳細については、「<a class="xref" target="_blank" rel="http://server.arcgis.com/ja/server/latest/administer/windows/scripting-arcgis-server-administration.htm" href="http://server.arcgis.com/ja/server/latest/administer/windows/scripting-arcgis-server-administration.htm">ArcGIS Server 管理のスクリプト</a>」をご参照ください。</li><li purpose="li" id="LI_952B7B2D50774CF58097DC68DC7094F5"> 仮想化: 仮想環境で操作を行う場合、仮想コンピューターのテンプレートを作成および使用して、新しいサイトを立ち上げることができます。各テンプレートには、GIS サービスで必要なデータのコピーが含まれます (データベースが使用されている場合を除く)。また、テンプレートには、公開および構成されているすべてのサービスも含まれます。既存のサービスの追加や更新などの変更が必要な場合、新しいテンプレートを作成し、後で新しい仮想コンピューターを起動して、ロード バランサーの下で使用されている既存の <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> コンピューターのプールをこれらの新しいコンピューターで置き換えることができます。仮想コンピューターのテンプレートは、古くなった <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> コンピューターを迅速に復元するためにも使用できます。</li></ul><p id="GUID-34948C59-10A8-43D3-9F4B-0BA0299F63D9"> この配置パターンで変更をサイトに適用する場合に推奨される手順は以下のとおりです。</p><div class="wfsteps" purpose="wfsteps"><h4></h4><div class="steps" id="ESRI_STEPS_784E84BE74D5437E9707B1399BAF19EE"><div class="step_title">手順:</div><ol><li purpose="step" id="ESRI_STEP_B00B728FB6064C4E9681C58120712FBB"><span purpose="cmd" id="GUID-212C7A42-1687-4CCF-8C9C-07B0C4F1FB24"> 管理上の変更は、まず、スタンバイ モードにあるサイトに対して行います。たとえば、アクティブにリクエストを処理していないサイトで新しいサービスを追加し、別のサービスのセキュリティを変更します。これにより、プライマリ サイトを使用しているアプリケーションには何も影響がないことが保証されます。</span></li><li purpose="step" id="ESRI_STEP_4EB66725C203433EAE03FF73D698F6EA"><span purpose="cmd" id="GUID-437B3239-C47C-4C38-B0B1-FCDD44E91446">変更を行ったスタンバイ サイトにすべてのリクエストを渡すようロード バランサーを手動で構成します。</span></li><li purpose="step" id="ESRI_STEP_4D19A677A2694061AFDF1806C895BB3B"><span purpose="cmd" id="GUID-6350C413-0F06-4D6C-AE2D-8AE3C45F3423">アイドル状態のサイトに同じ変更を適用します。</span></li><li purpose="step" id="ESRI_STEP_18542AF42544419FA949DC39C30CDBD4"><span purpose="cmd" id="GUID-43995EA3-BF8D-431F-9636-94A578E0E428">リクエストが元のプライマリ サイトに送られるようにロード バランサーの構成を元に戻して、スタンバイ サイトをスタンバイ モードのままにします。</span></li></ol></div></div><p id="GUID-87CCE021-1815-4423-8A82-75FB64408A6B"> 上記の手順でサイトに対して行った変更は、<span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> Manager、スクリプト、または仮想イメージを使用して手動で適用できます。</p></div><div class="section2" id="ESRI_SECTION2_7A70BE1D4E11428099693C68837E9A51" purpose="section2"><h3>非同期ジオプロセシング タスクおよび実行時間の長いタスク</h3><p id="GUID-63ABF49E-433F-4944-AAC1-5820842EE1EF"> ロード バランサーがスタンバイ サイトに切り替わると、プライマリ サイトのアクティブなリクエストはすべて失われます。たとえば、ジオプロセシング タスクなど、実行時間の長いリクエストがフェイルオーバーの発生時に実行されている場合、そのタスクは、クライアント アプリケーションによってスタンバイ サイトで再開される必要があります。</p></div><div class="section2" id="ESRI_SECTION2_AD2A918F0F5D4FF59EEDA3502C56B77A" purpose="section2"><h3>トークンベースのセキュリティの使用</h3><p id="GUID-D8F944FD-F648-4A63-84EB-013DDE5EE2F1"> トークンベースの認証 (GIS 層認証とも呼ばれる) を使用している場合、この構成内のすべてのサイトがまったく同じ共有トークン鍵を使用することが重要です。それ以外の場合、プライマリ サイトで生成されたトークンは、スタンバイ サイトに対して使用されるときに有効にはなりません。複数のサイト間で共有トークン鍵を複製する方法については、「<a class="xref" target="_blank" rel="http://server.arcgis.com/ja/server/latest/administer/windows/about-arcgis-tokens.htm" href="http://server.arcgis.com/ja/server/latest/administer/windows/about-arcgis-tokens.htm">ArcGIS トークンについて</a>」と「<a class="xref" target="_blank" rel="http://server.arcgis.com/ja/server/latest/administer/windows/editing-token-settings-in-manager.htm" href="http://server.arcgis.com/ja/server/latest/administer/windows/editing-token-settings-in-manager.htm">ArcGIS Server Manager でのトークン設定の編集</a>」をご参照ください。</p></div></div><div class="section1" id="ESRI_SECTION1_BF8390AFC33E4EE28CC8EFEA035E1177" purpose="section1"><h2>メリット</h2><ul purpose="ul" id="UL_D574A80631724B608ABA0C3675CC3E59"><li purpose="li" id="LI_B0AE7ABEB5DE479E8502D99B03B1A1AB">アクティブ/パッシブ フェイルオーバー構成では、追加のライセンス料金なしで、冗長性のある <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 層を構築できます。追加のコストなしで、スタンバイ サーバーのライセンスを取得できます。</li></ul></div><div class="section1" id="ESRI_SECTION1_9A6F1AE806F140AD80FB926FCF4A55CA" purpose="section1"><h2>デメリット</h2><ul purpose="ul" id="UL_2C134694CD7344C2B3B6E70AD1BDB471"><li purpose="li" id="LI_B00353D7F391425ABB1010D183B89649">ロード バランサーの内側にある各サイトは互いに独立しています。各サイトはそれぞれ独自の構成ストアとサーバー ディレクトリを備えており、別々に管理する必要があります。このため、サイトのサービスまたはデータの変更頻度が高い場合は、管理上のオーバーヘッドが大幅に増加する可能性があります。</li><li purpose="li" id="LI_F90D1CC466E14AA49D912E0C125EC2AC">スタンバイ サイトに切り替わると、プライマリ サイトのアクティブなリクエストはすべて失われます。</li></ul></div><div class="footer"> Copyright © 1995-2017 Esri. All rights reserved. </div></div></body></html>