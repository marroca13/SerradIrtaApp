<html lang="zh-cn" xml:lang="zh-cn"><head>
<META http-equiv="Content-Type" content="text/html">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><META name="description" content="生产站点的相对最简单的配置是通过反向代理（例如第三方反向代理服务器或 ArcGIS Web Adaptor）提供一个 ArcGIS Server 计算机。"><meta name="content-language" content="zh-cn"><link href="rsrc/htmlhelp.css" rel="stylesheet" type="text/css"><title>ArcGIS - 
使用反向代理服务器的单机部署</title>
                <script type="text/javascript" language="JavaScript">
                    var pathL  = self.location.pathname.split ("/");
                    var fname = pathL[pathL.length-1];
                    var i = fname.lastIndexOf (".htm");
                    if (i>=0) {
                    fname = fname.substring (0, i)
                    } else {
                    //??
                    }
                    if (self.location.hash) {
				    		      fname = fname + self.location.hash;
						        }
                    self.location.replace ("../index.html#//" + fname);
                </script>
                </head><!--Publication GUID: [GUID-FB5257BE-DC53-48C6-82F8-1DA075B0A617]--><!--Topic GUID: [GUID-D32FA68C-96A1-47D7-BC5D-1812D88B121A]--><body><div id="content"><div class="header"><h1>
使用反向代理服务器的单机部署</h1><div id="breadcrumb"></div></div>
<p id="GUID-212D5C48-1B85-45B9-8749-AB2B8C3D9139">该部署是<a class="xref" rel="01n1/01n10000002w000000.htm" href="01n1/01n10000002w000000.htm">单机部署</a>的一个变化，其中<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/server/latest/administer/windows/using-a-reverse-proxy-server-with-arcgis-server.htm" href="http://server.arcgis.com/zh-cn/server/latest/administer/windows/using-a-reverse-proxy-server-with-arcgis-server.htm">反向代理服务器</a>将添加到站点。反向代理服务器充当寻求 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 站点资源并将额外的安全功能添加到站点部署的客户端请求中介。</p><p id="GUID-9711BB40-A27F-42D2-80D9-180E626B5928"> ArcGIS Web Adaptor 是 Esri 中的反向代理实现，可在<a class="xref" rel="01n1/01n100000034000000.htm" href="01n1/01n100000034000000.htm">最常见的 web 应用程序服务器</a>中配置。或者，您可以选择利用其他第三方反向代理 web 服务器。</p><p id="GUID-AC4D049B-1DD3-4257-9736-771062A802BF">如下图所示，ArcGIS Web Adaptor 或第三方反向代理服务器通常在单独的 web 服务器计算机上进行配置，尽管也可以通过 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 将其定位于同一点。</p><p id="GUID-CC17478D-83F4-4241-81EC-F204FC1AD30C"> 对于客户端应用程序而言，直接访问 GIS 服务和通过代理进行访问没有差别。但是，作为 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 管理员，您可能会出于以下的一个或多个原因使用反向代理服务器：</p><p id="GUID-D9F6D7D8-602E-46FD-991F-56DEEAD7EEDD"><div class="image" purpose="image"><table><tr><td><img class="break" src="01n1/GUID-B0DCED81-BA6B-4103-AB6D-521F1939A100-web.png" purpose="img" alt="反向代理安装在指定 web 服务器上的单机站点" title="反向代理安装在指定 web 服务器上的单机站点"></td></tr><tr><td><div class="caption" purpose="caption">第三方反向代理安装在指定 web 服务器上的单机站点</div></td></tr></table></div></p>
<div class="section1" id="ESRI_SECTION1_5365D260725C42CDB33EDCBA245ADA65" purpose="section1"><h2>通过标准端口访问 GIS 服务</h2><p id="GUID-4B4B437F-DC4B-4CC8-BCA3-C7909471C220">如果不使用反向代理服务器，则客户端将通过 <span class="usertext">http://gisserver.domain.com:6080</span> 或 <span class="usertext">https://gisserver.domain.com:6443</span> 直接连接到 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>（如果已配置 HTTPS）。您无法更改 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 使用的<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/server/latest/administer/windows/ports-used-by-arcgis-server.htm" href="http://server.arcgis.com/zh-cn/server/latest/administer/windows/ports-used-by-arcgis-server.htm">默认端口</a>。如果希望客户端应用程序使用标准端口，例如将 80 和 443 分别用于 HTTP 和 HTTPS，则需要配置反向代理和直接客户端以访问服务。例如，您可以在 <span class="usertext">http://proxy.domain.com/arcgis</span> 或 <span class="usertext">http://proxy.domain.com/myGIS</span> 配置反向代理。</p></div><div class="section1" id="ESRI_SECTION1_017A251D747244C9B665F99FFC6258F5" purpose="section1"><h2>在组织的防火墙后面隔离 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span></h2><p id="GUID-89B1F282-13EC-49A9-AF1E-E0AFA6C989A0">如果希望服务和应用程序在 Internet 公开可用，则建议使用反向代理 web 服务器配置在组织的防火墙后面隔离 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>。在该配置中，从 Internet 接收的请求将通过冻结所有端口（除 HTTP 端口 80 和 HTTPS 端口 443 之外）的防火墙。您的反向代理 web 服务器收到请求，使用端口 6080 或 6443（用于 HTTP 或 HTTPS）将其通过其他防火墙传递至 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>，然后将响应发送回客户端。下图显示反向代理服务器如何位于外围网络中帮助您控制安全的内部网络访问。</p><p id="GUID-04B40C7C-AFA1-4AF8-AC23-4CE146F8DA79"><div class="image" purpose="image"><table><tr><td><img class="break" src="01n1/GUID-DBC9A501-BD3B-4E76-B8A2-BCB29535D578-web.png" purpose="img" alt="连接到" title="连接到"></td></tr></table></div></p><p id="GUID-0DA19151-9A7D-4108-959A-A70DDB40BEF1">要了解如何将反向代理服务器集成到 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>，请参阅<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/server/latest/administer/windows/using-a-reverse-proxy-server-with-arcgis-server.htm" href="http://server.arcgis.com/zh-cn/server/latest/administer/windows/using-a-reverse-proxy-server-with-arcgis-server.htm">将反向代理服务器与 ArcGIS Server 结合使用</a>。</p></div><div class="section1" id="ESRI_SECTION1_B47C8B7AFC7449CE8E0CC52A2F06C39D" purpose="section1"><h2>冻结对站点的管理权限</h2><p id="GUID-06620085-D4F3-415A-9CEB-13B3167A544F">反向代理服务器可用于冻结对站点中特定资源的访问权限。例如，可配置反向代理以冻结对 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> Manager 和 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 管理员目录的访问权限。这是一种很好的做法，尤其是在为 Internet 提供 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 服务的情况下。</p><p id="GUID-10EA474B-87D5-441E-95BF-2F26AFA42BA5"> 使用 ArcGIS Web Adaptor 时，根据<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/server/latest/administer/windows/configure-arcgis-web-adaptor-after-installation.htm" href="http://server.arcgis.com/zh-cn/server/latest/administer/windows/configure-arcgis-web-adaptor-after-installation.htm">安装后配置 Web Adaptor</a> 中的说明禁用对站点的管理权限。如果要使用第三方反向代理服务器，则参阅其特定文档以冻结对所有尝试访问 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> Manager (<span class="usertext">proxy.domain.com/arcgis/manager/</span>) 或 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 管理员目录 (<span class="usertext">proxy.domain.com/arcgis/admin/</span>) 的请求的访问权限。</p><p id="GUID-6B020F3C-E34A-4DB4-B713-92B31168ABF3"> 尽管通过反向代理访问站点时将冻结管理权限，但通过其默认端口 (6080 或 6443) 直接访问
<span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 时，仍然可以使用管理权限。应适当使用防火墙来控制可在何处访问这些端口。</p></div><div class="section1" id="ESRI_SECTION1_6B937290F52246A7B49DC5FF5E286234" purpose="section1"><h2>在您自己的 web 服务器中使用功能</h2><p id="GUID-DEF4E7ED-B69C-4622-B638-D19C211C7E54">Web 服务器的很多功能都可能要用作 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 部署的一部分。通过反向代理服务器共享 GIS 服务，使您可以使用 web 服务器的登录、缓存和安全功能。</p><ul purpose="ul" id="UL_430746EA18DB422A9648B28D66CE4FF3"><li purpose="li" id="LI_F1F3D98C03C148C9B04A4D8162B27B46">Web 层身份验证: 默认情况下，<span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 使用<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/server/latest/administer/windows/about-arcgis-tokens.htm" href="http://server.arcgis.com/zh-cn/server/latest/administer/windows/about-arcgis-tokens.htm">基于令牌的身份验证</a>（通常称为 ArcGIS 基于令牌或 GIS 层身份验证）。或者，您可以选择配置包含 web 层身份验证的 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>。通过该方法可使 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 将身份验证委托给您自己的 web 服务器。 如果需要 web 层身份验证，则必须使用 ArcGIS Web Adaptor。通过第三方反向代理 web 服务器无法使用 Web 层身份验证。</li><li purpose="li" id="LI_33B4C34B5ACA4314BE2E611EB7731897">记录：<span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 日志包含 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 服务的特定信息，例如调用了哪种操作、<span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 调用的执行时间以及在 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 中触发的警告和错误。可通过 web 服务器中的日志来补充该信息，这些日志可提供 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 日志中不存在的详细信息，例如发出请求的 IP 地址、用户代理、引用网址等等。</li><li purpose="li" id="LI_8C344324013E47E39DA236FC3623A0DD">其他功能: 大多数 web 服务器均可提供用于严格控制请求和响应的选项。例如，可将过滤规则应用于收到的请求、冻结特定 IP 地址或域名的访问权限等等。</li></ul></div><div class="section1" id="ESRI_SECTION1_5399D2DD35D44DB99F451A0F3461CA30" purpose="section1"><h2>总结</h2><p id="GUID-F521195F-BD24-43A2-BA5C-D629E74C568D">ArcGIS Web Adaptor 或第三方反向代理服务器是对 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 单机部署的良好补充。两者皆提供附加安全功能。如果计划为 Internet 提供 GIS 服务，则强烈建议使用上述的其中一种，根据安全要求，甚至对于 intranet 部署也有必要使用。</p><div class="section2" id="ESRI_SECTION2_695C10EAEC2D4353ACABE9696729B025" purpose="section2"><h3>优点</h3><ul purpose="ul" id="UL_CA5E2EE4C2974ADAB89F432BA07AC466"><li purpose="li" id="LI_9CA6DA2321EB493ABC9EF36821FD6422">通过额外的安全级别来补充<a class="xref" rel="01n1/01n10000002w000000.htm" href="01n1/01n10000002w000000.htm">单机部署</a>。</li></ul></div><div class="section2" id="ESRI_SECTION2_09FC933129414631A3B1CE0DE247FC72" purpose="section2"><h3>缺点</h3><ul purpose="ul" id="UL_B6E043DE0B6543EA98F315A66435F59A"><li purpose="li" id="LI_135DE9A1D0794D329FB78EE89DED36B5">使用反向代理服务器有可能增加 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 服务请求的开销。针对大型且复杂 (嵌套组或联合组) 的企业标识存储使用 web 层身份验证时尤其如此。</li><li purpose="li" id="LI_26C494BD8FF94668A36D8C513C66A2CD">不具备高可用性; 如果 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机和反向代理服务器中的任何一个离线，则其就是单点故障。有关详细信息，请参阅<a class="xref" rel="01n1/01n10000002s000000.htm" href="01n1/01n10000002s000000.htm">单机高可用性 (主动 - 被动)</a> 部署。</li></ul></div></div>
<div class="footer"> Copyright © 1995-2017 Esri. All rights reserved. </div></div></body></html>