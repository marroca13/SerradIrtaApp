<html lang="zh-cn" xml:lang="zh-cn"><head>
<META http-equiv="Content-Type" content="text/html">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><META name="description" content="一个站点可包含多个 ArcGIS Server 计算机，以处理增加的流量或在其中一个计算机离线时快速地提供一个后备服务器。"><meta name="content-language" content="zh-cn"><link href="rsrc/htmlhelp.css" rel="stylesheet" type="text/css"><title>ArcGIS - 
具有第三方负载均衡器的多机部署</title>
                <script type="text/javascript" language="JavaScript">
                    var pathL  = self.location.pathname.split ("/");
                    var fname = pathL[pathL.length-1];
                    var i = fname.lastIndexOf (".htm");
                    if (i>=0) {
                    fname = fname.substring (0, i)
                    } else {
                    //??
                    }
                    if (self.location.hash) {
				    		      fname = fname + self.location.hash;
						        }
                    self.location.replace ("../index.html#//" + fname);
                </script>
                </head><!--Publication GUID: [GUID-FB5257BE-DC53-48C6-82F8-1DA075B0A617]--><!--Topic GUID: [GUID-08196164-3CAB-4F08-9C3E-C5BC43FF8C23]--><body><div id="content"><div class="header"><h1>
具有第三方负载均衡器的多机部署</h1><div id="breadcrumb"></div></div>
<p id="GUID-7D1F5381-6018-4B2E-A173-E6FB8DB627C3"> <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 支持多机站点的配置。在多机站点中，可管理两台或多台服务器，并将其用作单个逻辑单元，这可为 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 管理员提供极大的灵活性，可通过添加或移除计算机来轻松调整站点的计算能力。多机站点可简化在多台 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机之间发布和更新服务的过程。</p><p id="GUID-FA3F35BB-BE81-4D99-8507-6ED393B11F72">在多机部署中，为了使站点能够正常运行，每台 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机必须具有相同版本号。此外，还必须向参与站点的所有计算机应用完全相同的许可。</p><p id="GUID-7AA1BAD4-6DA4-4960-BFE4-38FCDA2633B2"> 常见多机配置包括在 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机池之前设置的第三方反向代理服务器或网络负载均衡器。</p><div class="image" purpose="image"><table><tr><td><img class="break" src="01n1/GUID-D4C995D9-D217-43B5-8405-C6865551E641-web.png" purpose="img" alt="具有多台" title="具有多台"></td></tr><tr><td><div class="caption" purpose="caption">具有多台 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机和一台负载均衡器的站点</div></td></tr></table></div><p id="GUID-7813AE69-5DA1-4ABF-B26A-8430294C93FD"> 多机配置的一个重要方面在于所有 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机共享同一配置存储和服务器目录。鉴于这种方式，管理员可使用 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> Manager 登录任何计算机并应用可影响站点内所有计算机的更改。</p><div class="section1" id="ESRI_SECTION1_14CC6AE269D74871B7D81EC84AB5DF75" purpose="section1"><h2><span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机、服务器目录和配置存储</h2><p id="GUID-33B1D0C7-B9C5-44FB-A84C-3F395C5C1167">由于多机配置中的所有 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机共享同一配置存储和服务器目录，因此您必须为服务器目录和配置存储选择网络位置。</p><p id="GUID-7AE3C15F-3E83-4E7A-B412-95BBB3274DE7"> 通常，选择域帐户作为 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 帐户，因为这样会简化对网络资源的数据访问权限的管理。但是，根据您自己的安全策略，您可能选择使用本地帐户。<span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 帐户（本地或域）需要对配置存储和服务器目录所在的网络共享具有写入权限。有关详细信息，请参阅 <a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/server/latest/administer/windows/accounts-used-by-arcgis-server.htm" href="http://server.arcgis.com/zh-cn/server/latest/administer/windows/accounts-used-by-arcgis-server.htm">ArcGIS Server</a> 使用的帐户。</p><p id="GUID-93BA97C6-C3B8-40B1-B630-D7515B596705">在多机站点中，所有 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>计算机最初都属于使用 4004 及以上端口的单个<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/server/latest/administer/windows/about-gis-server-clusters.htm" href="http://server.arcgis.com/zh-cn/server/latest/administer/windows/about-gis-server-clusters.htm">集群</a>。从 10.4 版本起，<span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 在进行新安装过程中默认设置为<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/server/latest/administer/windows/about-single-cluster-mode.htm" href="http://server.arcgis.com/zh-cn/server/latest/administer/windows/about-single-cluster-mode.htm">单个集群模式</a>。该模式不包括集群中计算机间的负载均衡。这不仅可以减少站点内的机器之间的网络流量，降低网络上的负载，还有助于更好地监控站点内的 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机。当从先前版本升级至 10.4 或更高版本时，将为当前未使用单个集群模式的单个集群站点启用该模式。已使用单个集群模式的单个集群站点以及较早版本中具有多个集群的站点会在升级时保留其设置。</p><p id="GUID-91E9E50C-6209-4D73-8EBD-86870C1C743A"> 如果站点使用的是多个集群，则会在每个群集内的所有 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机间进行负载均衡。从本质上来说，集群是相互独立的计算机组，分别运行专用的服务集。</p><p id="GUID-34659E5E-FAAD-4401-9537-A5F1AC6E06A5">例如，即使请求已被定向到集群内部或外部的特定计算机，仍会将收到的请求分配给集群中的可用 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机。接下来，此计算机就会执行绘制地图、查找地址坐标、运行地理处理工具等工作，并将结果返回到客户端。如果计算机离线，或请求的服务是在其他集群中运行的，则会将请求转发至包含该服务的集群中。该集群中的 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机会相应地进行负载均衡，并处理该请求。</p></div><div class="section1" id="ESRI_SECTION1_68CB0DD2AAD84B5797E32AD99C6F8A19" purpose="section1"><h2>数据</h2><p id="GUID-683DCBD4-1E50-44E4-BE33-D0952AA667B5"> 如在其他部署方案中所述，在使用基于文件的数据时，强烈建议您将本地资源用于 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机。这样虽会迫使您将数据复制到所有计算机，但却可降低网络流量，最终实现服务的较高性能。您应对此选择加以考虑并在恰当时使用。如果将数据保存在所有计算机本地是一种实用的方法，则通常需要指定数据的大小和更新频率。</p><p id="GUID-C00F3955-D0D0-4E89-BF84-6AEFAC472A15"> 如果在此部署模式中使用数据库，则始终使用专用硬件十分重要。保持数据库层独立于 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 层。</p></div><div class="section1" id="ESRI_SECTION1_C0B4AA3B947E494CAF38E2D06896D1C7" purpose="section1"><h2>第三方反向代理服务器或网络负载均衡器</h2><p id="GUID-59009666-37AB-4677-8DA2-E984B444C86F"> 在此配置中，<span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 客户端从不直接连接 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机。相反，可通过中间层连接它们，该中间层可提供安全功能并让整个站点具有更高的故障应对能力。</p><p id="GUID-0E9F0A14-AFE9-4891-9680-43EED7082B90"> 从安全性角度考虑，不推荐您访问相同的通道来使用和管理您的站点。通常，只能通过网络部分或可直接访问 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机的特定计算机执行管理任务，如通过 6080 或 6443 端口。可通过指定仅允许特定的 IP 地址访问管理员目录中的服务来克服上述问题。这由服务器的<a class="xref" target="_blank" rel="http://resources.arcgis.com/zh-cn/help/arcgis-rest-api/02r3/02r3000001t9000000.htm" href="http://resources.arcgis.com/zh-cn/help/arcgis-rest-api/02r3/02r3000001t9000000.htm">安全配置</a>中的 <span class="usertext">allowedAdminAccessIPs</span> 属性进行控制。要了解如何配置该属性以限制到服务器的访问，请参阅<a class="xref" target="_blank" rel="http://resources.arcgis.com/zh-cn/help/arcgis-rest-api/02r3/02r3000001rw000000.htm" href="http://resources.arcgis.com/zh-cn/help/arcgis-rest-api/02r3/02r3000001rw000000.htm">更新安全性配置</a>中的示例。</p><p id="GUID-4D28AF6E-A555-4822-8C1B-D7DF5D01FF34"> 来自客户端应用程序的请求始终通过反向代理汇集，以防止使用任何管理端点。大多数第三方代理允许您过滤包含特定 URL 模式的收到的请求。阻止使用 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 管理员目录 (<span class="usertext">http://gisserver.domain.com:6080/arcgis/admin</span>) 或 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> Manager (<span class="usertext">http://gisserver.domain.com:6080/arcgis/manager</span>) 中资源的收到的请求可通过反向代理有效阻止所有管理任务。</p><p id="GUID-6DC6A4F1-EF76-410B-A352-EBDFE31293F0"> 您的反向代理还可用作站点的负载均衡器。对于此配置，简单的负载均衡算法（如轮询）已足够。</p><p id="GUID-B9492F73-C386-4405-A524-9A134106B74D">如果您的网络负载均衡器支持健康检查功能，您可以使用 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 的健康检查端点来确定站点是否可以接收请求。这有助于快速确定站点中是否存在软件或硬件故障。有关详细信息，请参阅 ArcGIS REST API 中的<a class="xref" target="_blank" rel="http://resources.arcgis.com/zh-cn/help/arcgis-rest-api/02r3/02r3000002n7000000.htm" href="http://resources.arcgis.com/zh-cn/help/arcgis-rest-api/02r3/02r3000002n7000000.htm">健康检查</a>。</p><p id="GUID-28E2F286-E703-4DAA-95BA-016946315B13">要了解如何将反向代理服务器集成到 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>，请参阅<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/server/latest/administer/windows/using-a-reverse-proxy-server-with-arcgis-server.htm" href="http://server.arcgis.com/zh-cn/server/latest/administer/windows/using-a-reverse-proxy-server-with-arcgis-server.htm">将反向代理服务器与 ArcGIS Server 结合使用</a>。</p></div><div class="section1" id="ESRI_SECTION1_7D80FDD6984A4CB89673169EC202AE9B" purpose="section1"><h2>优点</h2><ul purpose="ul" id="UL_95A679B9F76D4BF689C7D662788FF04D"><li purpose="li" id="LI_282DE4C9AD6B4A4988654E435162F3EB">单个 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 站点可提供在多个计算机之间轻松管理 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 及其服务的方法。</li><li purpose="li" id="LI_27251CF49540483AB4F13EA8C01AE620"> 通过添加或移除 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机来轻松调整站点的能力。</li><li purpose="li" id="LI_771CF22F97D84BABBF6A2695DEBED2F2">在多台 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机之间进行负载均衡。</li></ul></div>
<div class="section1" id="ESRI_SECTION1_41EFAD1B165B4AD7BB2360CACBFE3F46" purpose="section1"><h2>缺点</h2><ul purpose="ul" id="UL_990D447AD1774E3BB15F91EC33862342"><li purpose="li" id="LI_A1774AA02A234F6B99B66A5C3C260121">使用共享网络位置的 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 目录和数据可降低高负载下的服务性能。</li><li purpose="li" id="LI_8E200906EA23425EAD7C18CEB73610F3">需要了解第三方负载均衡器。</li><li purpose="li" id="LI_6F2309574D9A4365BB40ED27E5601F24">不支持 web 层身份验证。如果要使用 web 层身份验证，请参阅<a class="xref" rel="01n1/01n10000002t000000.htm" href="01n1/01n10000002t000000.htm">具有 ArcGIS Web Adaptor 的多机部署</a>。</li></ul></div><div class="footer"> Copyright © 1995-2017 Esri. All rights reserved. </div></div></body></html>