<html lang="zh-cn" xml:lang="zh-cn"><head>
<META http-equiv="Content-Type" content="text/html">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><META name="description" content="可使用集成的 Windows 身份验证 (IWA) 安全访问门户。使用 IWA 时，通过 Microsoft Windows Active Directory 管理登录帐户。用户无需登录和注销门户网站，而是在打开网站时使用 Windows 登录帐户登录门户网站。"><meta name="content-language" content="zh-cn"><link href="rsrc/htmlhelp.css" rel="stylesheet" type="text/css"><title>ArcGIS - 在门户中使用集成的 Windows 身份验证</title>
                <script type="text/javascript" language="JavaScript">
                    var pathL  = self.location.pathname.split ("/");
                    var fname = pathL[pathL.length-1];
                    var i = fname.lastIndexOf (".htm");
                    if (i>=0) {
                    fname = fname.substring (0, i)
                    } else {
                    //??
                    }
                    if (self.location.hash) {
				    		      fname = fname + self.location.hash;
						        }
                    self.location.replace ("../index.html#//" + fname);
                </script>
                </head><!--Publication GUID: [GUID-FB5257BE-DC53-48C6-82F8-1DA075B0A617]--><!--Topic GUID: [GUID-4DF90B15-E22D-4B5C-B1C2-2E2AD7299576]--><body><div id="content"><div class="header"><h1>在门户中使用集成的 Windows 身份验证</h1><div id="breadcrumb"></div></div>
<p id="GUID-D10892F6-5964-41A5-B160-74550AA06784">可使用集成的 Windows 身份验证 (IWA) 安全访问门户。使用 IWA 时，通过 Microsoft Windows Active Directory 管理登录帐户。用户无需登录和注销门户网站，而是在打开网站时使用 Windows 登录帐户登录门户网站。</p><p id="GUID-6A78F926-64CF-4D39-B5BF-5F03A38650E7">要使用集成的 Windows 身份验证，必须使用部署到 Microsoft 的 IIS Web 服务器的 ArcGIS Web Adaptor (IIS)。无法使用 ArcGIS Web Adaptor（Java 平台）来执行集成的 Windows 身份验证。如果您尚未执行此操作，请在门户中<a class="xref" rel="01n1/01n100000019000000.htm" href="01n1/01n100000019000000.htm">安装</a>并<a class="xref" rel="01n1/01n10000001p000000.htm" href="01n1/01n10000001p000000.htm">配置</a> ArcGIS Web Adaptor (IIS)。</p><div class="notes" id="GUID-6B8E1503-85C4-4367-9DF6-2931651476EB"><div class="note"><img class="note_img" src="rsrc/note.png" alt="注" title="注"><span>注：</span></div><div class="tipbody"><p id="GUID-5353424E-0487-486A-BC14-D109B79E0BA8">如果您要将 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 站点添加到您的门户中，并且希望在站点上使用 Web 层身份验证，那么在将其添加到门户前，您需要在使用站点配置的 <span purpose="ph" translate="no" varid="WebAdaptorforArcGIS">ArcGIS Web Adaptor</span> 上禁用 Web 层身份验证（例如 basic 或 digest），并启用匿名访问。虽然这听起来可能有悖常理，但是必须执行此操作才能使站点自由地与门户联合并读取门户中的用户和角色。如果您的 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 站点尚未使用 Web 层身份验证，则无需执行任何操作。有关如何将服务器添加到门户的说明，请参阅<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/federate-an-arcgis-server-site-with-your-portal.htm" href="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/federate-an-arcgis-server-site-with-your-portal.htm">联合 ArcGIS Server 站点与门户</a>。</p></div></div><div class="section1" id="GUID-C0ADC23D-5584-451E-9C29-30E9BAF8B934" purpose="section1"><h2>
配置门户以使用 Windows Active Directory</h2><p id="GUID-D2FA1395-9A29-4C5E-8B08-7A706B8632B7">首先，将门户配置为全部使用 HTTPS 进行通讯。然后，更新门户的身份存储以使用 Active Directory 用户和组。</p><div class="section2" id="ESRI_SECTION2_3AAAFED3A07D4D44BEB558AD4436C4AB" purpose="section2"><h3>配置门户以对所有通信使用 HTTPS</h3><div class="wfsteps" purpose="wfsteps"><h4></h4><div class="steps" id="ESRI_STEPS_229C1545BD9145CFB0D06C5BE30300FE"><div class="step_title">步骤：</div><ol><li purpose="step" id="ESRI_STEP_D741BAF64E69494298D73A60D666257A"><span purpose="cmd" id="GUID-5FEF1BC7-2AB6-441B-B4E6-85FF58F96676">以组织管理员的身份登录到门户网站。URL 格式为 <span class="usertext">https://webadaptorhost.domain.com/webadaptorname/home</span>。</span></li><li purpose="step" id="ESRI_STEP_D4BC68DFB9C545C79957E97640804759"><span purpose="cmd" id="GUID-1D2BEE83-93DD-43D6-BC54-6F19E6FCC249">在<span class="uicontrol">组织</span>页面上，单击<span class="uicontrol">编辑设置</span> &gt; <span class="uicontrol">安全性</span>。</span></li><li purpose="step" id="ESRI_STEP_3BA66D03DF4B43B285E9D6300381B487"><span purpose="cmd" id="GUID-B904C2F9-C7DE-4EFF-A53A-14D28F216BAE">选中<span class="uicontrol">允许仅通过 HTTPS 访问门户</span>。</span></li><li purpose="step" id="ESRI_STEP_2A900B3D04154322A0C2A15C158648F9"><span purpose="cmd" id="GUID-9506BE76-C380-4DCF-919A-BD5D965B934C">单击<span class="uicontrol">保存</span>应用更改。</span></li></ol></div></div></div><div class="section2" id="ESRI_SECTION2_3F9DA6DAFD0D4E7FB63C83F7E18B6939" purpose="section2"><h3>更新门户的身份存储</h3><div class="wfsteps" purpose="wfsteps"><h4></h4><div class="steps" id="ESRI_STEPS_AABE97D2823D4D9B9F5DEDA1AEAF5C9B"><div class="step_title">步骤：</div><ol><li purpose="step" id="ESRI_STEP_5E56A1154E6C423A9712616722B08B1E">
<span purpose="cmd" id="GUID-A837A868-62BE-42D2-BDBF-51CAA1E10F7A">
以组织管理员的身份登录到 ArcGIS Portal Directory。URL 格式为 <span class="usertext">https://webadaptorhost.domain.com/webadaptorname/portaladmin</span>。</span>
</li><li purpose="step" id="ESRI_STEP_1E86E64409224EF2AE9B7442CFF04EBD">
<span purpose="cmd" id="GUID-3F96A811-3FFF-4971-BBAF-AC5FA7809D9B">
单击<span class="uicontrol">安全性</span> &gt; <span class="uicontrol">配置</span> &gt; <span class="uicontrol">更新身份存储</span>。</span>
</li><li purpose="step" id="ESRI_STEP_E61445A0397B470292B529793ACD6928"><span purpose="cmd" id="GUID-3809F5CE-A011-4FBE-9BAE-CA449E4AC89F">在<span class="uicontrol">用户存储配置（JSON 格式）</span>文本框中，粘贴组织的 Windows Active Directory 用户配置信息（JSON 格式）。或者，您可以将下列示例更新为特定于组织的用户信息。</span><div class="info" purpose="info"><p id="GUID-6AFE6495-B740-4167-8DA6-5035D8D43D2A"><pre purpose="pre" id="GUID-91A7214D-C850-419C-ABB2-7791CE1BF5AF">{
  "type": "WINDOWS",
  "properties": {
    "userPassword": "secret",
    "isPasswordEncrypted": "false",
    "user": "mydomain\\winaccount",
    "userFullnameAttribute": "cn",
    "userEmailAttribute": "mail",
    "caseSensitive": "false"
  }
}</pre></p></div><div class="info" purpose="info"><p id="GUID-F5665A49-7838-459A-88C2-5CC6C013CBB5">大多数情况下，只需要更改 <span class="usertext">userPassword</span> 和 <span class="usertext">user</span> 参数的值。尽管以明文形式输入密码，但在单击<span class="uicontrol">更新配置</span>（下面）时将对其进行加密。为用户参数指定的帐户只需要具有在网络上查找电子邮件地址和 Windows 帐户全名的权限。如果可以，请指定密码未过期的帐户。</p><p id="GUID-96F91AFC-2C23-4B86-AFAE-59F90E399385">在将 Windows Active Directory 配置为区分大小写的特殊情况下，请将 <span class="usertext">caseSensitive</span> 参数设置为 <span class="usertext">true</span>。</p></div></li><li purpose="step" id="ESRI_STEP_EC581E9FFCC54831B72AB60EE7F432FE"><span purpose="cmd" id="GUID-C715E37B-127F-4159-8CF1-581E696000EB">如果想要在使用身份存储中的现有企业组的门户中<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/create-groups.htm" href="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/create-groups.htm">创建组</a>，请将组织的 Windows Active Directory 组配置信息（JSON 格式）粘贴到<span class="uicontrol">组存储配置（JSON 格式）</span>文本框中，如下所示。或者，您可以将下列示例更新为特定于组织的群组信息。如果只想使用门户内置群组，请删除文本框中的所有信息，并跳过此步骤。</span><div class="stepexample" purpose="stepexample"><p id="GUID-C9FF99D0-02BE-47F3-A87D-94C22C2E30F3"><pre purpose="pre" id="GUID-791F3FC9-4E73-4E2E-ABB1-2D017B48767D">{
  "type": "WINDOWS",  "properties": {
    "isPasswordEncrypted": "false",    "userPassword": "secret",    "user": "mydomain\\winaccount"
  }
}</pre></p></div><div class="info" purpose="info"><p id="GUID-FE9073CB-6182-4074-A1A8-6302B389F038">大多数情况下，只需要更改 <span class="usertext">userPassword</span> 和 <span class="usertext">user</span> 参数的值。尽管以明文形式输入密码，但在<span class="uicontrol">更新配置</span>（下面）时将对其进行加密。为用户参数指定的帐户只需要具有在网络上查找 Windows 组的名称的权限。如果可以，请指定密码未过期的帐户。</p></div></li><li purpose="step" id="ESRI_STEP_98FFC9ED5DEF4D1EA9D91DA74DBB2E2A"><span purpose="cmd" id="GUID-E0563151-F92D-4ED6-84DE-B395D4A680A0">单击<span class="uicontrol">更新配置</span>保存更改。</span></li><li purpose="step" id="ESRI_STEP_A52B573C9C4D48EAABE72D565AD866F6"><span purpose="cmd" id="GUID-3BA49413-1E68-4F64-8078-52D0E0D4681F">如果您已<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/configuring-a-highly-available-portal.htm" href="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/configuring-a-highly-available-portal.htm">配置高可用性门户</a>，请重新启动每台门户计算机。有关完整的说明，请参阅<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/stopping-and-starting-the-portal.htm" href="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/stopping-and-starting-the-portal.htm">停止和启动门户</a>。</span></li></ol></div></div></div><div class="section2" id="ESRI_SECTION2_0B89E5358DB64704B011D78AB9FDDB40" purpose="section2"><h3>还可配置其他身份存储参数</h3><p id="GUID-4A275662-4D2B-4E7F-A0EE-FA7955313EB0">还有其他身份存储配置参数，可使用 ArcGIS Portal Directory 管理 API 进行修改。这些参数包含诸如限制企业级用户登录门户时是否自动刷新群组、设置成员资格刷新间隔以及定义是否检查多个用户名格式等选项。有关详细信息，请参阅<a target="_blank" class="xref" href="http://resources.arcgis.com/en/help/arcgis-rest-api/index.html#/Update_Identity_Store/02r300000249000000/" rel="http://resources.arcgis.com/en/help/arcgis-rest-api/index.html#/Update_Identity_Store/02r300000249000000/">更新身份存储</a>。</p></div></div>
<div class="section1" id="ESRI_SECTION1_65AC88E72E2B4CFBBBC061311F9B4EA4" purpose="section1"><h2>将企业帐户添加到门户中</h2><p id="GUID-42FC0409-585C-44B5-8763-ECB7FEA2EBDB">默认情况下，企业用户可以访问门户网站。然而，他们只能查看共享给组织中所有人的项目。这是因为企业帐户未添加到门户中，且未授予访问权限。</p><p id="GUID-2DE231B0-B5BB-4528-A75F-6908711CEEE6">通过以下方法之一将帐户添加到门户中：</p><ul purpose="ul" id="UL_BAB11D35736B4CF6A2ED6C5342961C9E"><li purpose="li" id="LI_A96C9F0C5FB84518823C85F1E41ADEB8"><a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/add-members-to-your-portal.htm#ESRI_SECTION2_8D9E0CE8A7A7444F8D6E93D56C949FEC" href="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/add-members-to-your-portal.htm#ESRI_SECTION2_8D9E0CE8A7A7444F8D6E93D56C949FEC">Portal for ArcGIS 网站</a>（逐一添加，通过 CSV 文件批量添加，或从现有的企业组添加）</li><li purpose="li" id="LI_FDB78957705B41B39CB7CC50659BF7A7"><a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/example-add-members-to-the-portal.htm" href="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/example-add-members-to-the-portal.htm">Python 脚本</a></li><li purpose="li" id="LI_CABBF7E85CBF46A2B960A51654B4FCC3"><a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/add-members-to-your-portal.htm#ESRI_SECTION1_29AF645AF75140698CA9879C3E059D39" href="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/add-members-to-your-portal.htm#ESRI_SECTION1_29AF645AF75140698CA9879C3E059D39">命令行实用程序</a></li><li purpose="li" id="LI_B0F677D7FC204892BE7C41B4A610EF68"><a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/automatic-registration-of-enterprise-accounts.htm" href="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/automatic-registration-of-enterprise-accounts.htm">自动</a></li></ul><p id="GUID-277D6BB4-21BE-42AB-9D03-93654CBDA803">建议至少将一个企业帐户指定为门户管理员。为此，可在添加帐户时选择<span class="uicontrol">管理员</span>角色。如果您拥有备选门户管理员帐户，可以将初始管理员帐户分配给用户角色或删除帐户。有关详细信息，请参阅<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/about-the-initial-administrator-account.htm" href="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/about-the-initial-administrator-account.htm">关于初始管理员帐户</a>。</p><p id="GUID-A9F5835B-5C7C-4E08-A934-A86BC7DD2D3C">添加帐户并完成以下步骤之后，用户将能够登录到组织并访问内容。</p></div><div class="section1" id="ESRI_SECTION1_95AEF455D151412C8D6BCA39ABFD5D0C" purpose="section1"><h2>配置 ArcGIS Web Adaptor 以使用 IWA</h2><div class="wfsteps" purpose="wfsteps"><h4></h4><div class="steps" id="ESRI_STEPS_82ACCC6BC7BB42A7970747BA9A0E3027"><div class="step_title">步骤：</div><ol><li purpose="step" id="ESRI_STEP_7A952BF7248647C2BF5032D42B5D0C37"><span purpose="cmd" id="GUID-0B3284F6-1DDE-47AB-AF07-B3E937C02A64">打开 Internet 信息服务 (IIS) 管理器。</span></li><li purpose="step" id="ESRI_STEP_D28051510A6A4892B4732EEE0D4980DA"><span purpose="cmd" id="GUID-C01CE922-3E65-4883-B01A-C2715086F951">在<span class="uicontrol">连接</span>面板中，找到并展开托管 ArcGIS Web Adaptor 的网站。</span></li><li purpose="step" id="ESRI_STEP_2222C45F7DAD48C89FEC736B93179284"><span purpose="cmd" id="GUID-D7D2FBC5-31A5-4390-A3C3-2F475A06C944">单击 ArcGIS Web Adaptor 的名称。默认名称为 <span class="usertext">arcgis</span>。</span></li><li purpose="step" id="ESRI_STEP_7FB61EC449D44EE99BF5CDD480FC02E6"><span purpose="cmd" id="GUID-0D77B6C5-5895-47F1-8763-29D22DCCC8B3">在<span class="uicontrol">主页</span>面板中，双击<span class="uicontrol">身份验证</span>。</span></li><li purpose="step" id="ESRI_STEP_A10D4A07E2E548C6AFD4A2AE618D4BCD"><span purpose="cmd" id="GUID-919EDA16-5F69-41FC-A556-433F2855F519">选择<span class="uicontrol">匿名身份验证</span>，然后单击<span class="uicontrol">禁用</span>。</span></li><li purpose="step" id="ESRI_STEP_1623B4D86C2C4D8B937FE27E65EF9F0D"><span purpose="cmd" id="GUID-0A3852A4-2ED0-46FF-ADF3-B23DF7627D3E">选择 <span class="uicontrol">Windows 身份验证</span>，然后单击<span class="uicontrol">启用</span>。</span></li><li purpose="step" id="ESRI_STEP_A0DB7F491EE943068065B73A533A5FBD"><span purpose="cmd" id="GUID-9BBD61FE-95DC-48CA-82A2-91000AF41397">关闭 Internet 信息服务 (IIS) 管理器。</span></li></ol></div></div></div>
<div class="section1" id="ESRI_SECTION1_47271E5059F1404C9C6C9B559AEA13B7" purpose="section1"><h2>验证是否可以使用 IWA 访问门户</h2><div class="wfsteps" purpose="wfsteps"><h4></h4><div class="steps" id="ESRI_STEPS_7F050EB93C97411E99C9F0CA951647BE"><div class="step_title">步骤：</div><ol><li purpose="step" id="ESRI_STEP_82F8DE0621354C45991AB4C99DD07CC6"><span purpose="cmd" id="GUID-D29085F5-6420-4DEB-B751-6E66ED1EEC0C">打开门户网站。URL 格式为 <span class="usertext">https://webadaptorhost.domain.com/webadaptorname/home</span>。</span></li><li purpose="step" id="ESRI_STEP_1373A5CED3A340189D210C5B913E5E36"><span purpose="cmd" id="GUID-1EBDC6FD-DDEF-4D86-AF86-A30BDE9DAC2E">验证系统将提示您输入企业帐户凭据，还是使用企业帐户自动登录。如果未出现此行为，请验证您登录到计算机所使用的 Windows 帐户是否已添加到门户。</span></li></ol></div></div></div><div class="section1" id="ESRI_SECTION1_3D97D2FCA96B431D83F810DBA064CA9E" purpose="section1"><h2>防止用户创建自己的内置帐户</h2><p id="GUID-472E0ED2-89A9-4322-A195-EF33FF73AFB2">为了防止用户创建自己的内置帐户，请禁用门户网站中的<span class="uicontrol">创建帐户</span>按钮和注册页面 (<span class="usertext">signup.html</span>)。这意味着所有成员都使用其企业凭据登录到门户，且无法创建不必要的成员帐户。有关完整说明，请参阅<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/disabling-users-ability-to-create-builtin-portal-accounts.htm" href="http://server.arcgis.com/zh-cn/portal/latest/administer/windows/disabling-users-ability-to-create-builtin-portal-accounts.htm">禁止用户创建内置门户帐户</a>。</p></div><div class="footer"> Copyright © 1995-2017 Esri. All rights reserved. </div></div></body></html>