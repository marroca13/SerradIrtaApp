<html lang="zh-cn" xml:lang="zh-cn"><head>
<META http-equiv="Content-Type" content="text/html">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><META name="description" content="一个站点可包含多个 ArcGIS Server 计算机，以处理增加的流量或在其中一个 ArcGIS Server 离线时快速地提供一个后备服务器。"><meta name="content-language" content="zh-cn"><link href="rsrc/htmlhelp.css" rel="stylesheet" type="text/css"><title>ArcGIS - 
通过 ArcGIS Web Adaptor 实现多机部署</title>
                <script type="text/javascript" language="JavaScript">
                    var pathL  = self.location.pathname.split ("/");
                    var fname = pathL[pathL.length-1];
                    var i = fname.lastIndexOf (".htm");
                    if (i>=0) {
                    fname = fname.substring (0, i)
                    } else {
                    //??
                    }
                    if (self.location.hash) {
				    		      fname = fname + self.location.hash;
						        }
                    self.location.replace ("../index.html#//" + fname);
                </script>
                </head><!--Publication GUID: [GUID-FB5257BE-DC53-48C6-82F8-1DA075B0A617]--><!--Topic GUID: [GUID-24EB1171-8DBB-4B71-8EB9-24D0AAE8D488]--><body><div id="content"><div class="header"><h1>
通过 ArcGIS Web Adaptor 实现多机部署</h1><div id="breadcrumb"></div></div>
<p id="GUID-5D4A77B3-8AB4-4C98-8563-2E46CDBAA8BB"> <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 支持多机站点的配置。在多机站点中，可管理两台或多台 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机，并将其用作单个逻辑单元，这可为 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 管理员提供极大的灵活性，可通过添加或移除 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机来轻松调整站点的计算能力。多机站点可简化在多台 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 之间发布和更新服务的过程。</p><p id="GUID-9BFAE792-E43E-421A-AE5A-359025AFC736">在多机部署中，为了使站点能够正常运行，每台 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 必须具有相同版本号。此外，还必须向参与站点的所有 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机应用完全相同的许可。</p><p id="GUID-657D9CD2-9021-46BC-B0E0-5034765ACC43"> 在其最简单的配置中，多机站点的配置方式为：将运行在自己 web 应用程序服务器上的 <span purpose="ph" translate="no" varid="WebAdaptorforArcGIS">ArcGIS Web Adaptor</span> 设置在由两台或多台 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 组成的服务器池之前。</p><p id="GUID-57F2C88A-E2E2-49E2-BD5E-67A66789C50A"><div class="image" purpose="image"><table><tr><td><img class="break" src="01n1/GUID-79F9644A-D779-409B-9E1B-AF6CD5F50C4F-web.png" purpose="img" alt="具有多台" title="具有多台"></td></tr><tr><td><div class="caption" purpose="caption">具有多台 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 的站点，其中数据存储在一台高可用性的数据服务器上</div></td></tr></table></div></p><p id="GUID-67A0E652-13DF-47DE-88A9-6FE0F1F893DA">多机配置的一个重要方面在于所有 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 共享同一配置存储和服务器目录。鉴于这种方式，管理员可使用 ArcGIS Server Manager 登录任何 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 并应用可影响站点内所有计算机的更改。如果要将站点与组织 web 层中的身份验证方法相集成，则此模式是理想的选择。</p><div class="section1" id="ESRI_SECTION1_02F47167CE3A4E078D4BDC4E4C638C9B" purpose="section1"><h2><span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>、服务器目录和配置存储</h2><p id="GUID-0971E9A0-F3F1-46CB-8C9F-8605D4994F38">由于多机配置中的所有 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 共享同一配置存储和服务器目录，因此您必须为服务器目录和配置存储选择网络位置。</p><p id="GUID-4DB61302-D4E6-46E6-808E-7164B2F4F834">通常，选择域帐户作为 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 帐户，因为这样会简化对网络资源的数据访问权限的管理。但是，根据您自己的安全策略，您可能选择使用本地帐户。<span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 帐户（本地或域）需要对配置存储和服务器目录所在的网络共享具有写入权限。有关详细信息，请参阅 <a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/server/latest/administer/windows/accounts-used-by-arcgis-server.htm" href="http://server.arcgis.com/zh-cn/server/latest/administer/windows/accounts-used-by-arcgis-server.htm">ArcGIS Server</a> 使用的帐户。</p><p id="GUID-93BA97C6-C3B8-40B1-B630-D7515B596705">在多机站点中，所有 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>计算机最初都属于使用 4004 及以上端口的单个<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/server/latest/administer/windows/about-gis-server-clusters.htm" href="http://server.arcgis.com/zh-cn/server/latest/administer/windows/about-gis-server-clusters.htm">集群</a>。从 10.4 版本起，<span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 在进行新安装过程中默认设置为<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/server/latest/administer/windows/about-single-cluster-mode.htm" href="http://server.arcgis.com/zh-cn/server/latest/administer/windows/about-single-cluster-mode.htm">单个集群模式</a>。该模式不包括集群中计算机间的负载平衡。这不仅可以减少站点内的机器之间的网络流量，降低网络上的负载，还有助于更好地监控站点内的 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>。当升级至 10.4 版本时，将为当前未使用单个集群模式的单个集群站点启用该模式。已使用单个集群模式的单个集群站点以及较早版本中具有多个集群的站点会在升级时保留其设置。</p><p id="GUID-C73E2845-3685-476F-89D4-ECAF4CD564BF"> 如果站点使用的是多个集群，则会在每个集群内的所有 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 间进行负载平衡。从本质上来说，集群是相互独立的 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 组，分别运行专用的服务集。</p><p id="GUID-34659E5E-FAAD-4401-9537-A5F1AC6E06A5">例如，即使请求已被定向到集群内部或外部的特定计算机，仍会将收到的请求分配给集群中的可用 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>。接下来，此 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 就会执行绘制地图、查找地址坐标、运行地理处理工具等工作，并将结果返回到客户端。如果计算机离线，或请求的服务是在其他集群中运行的，则会将请求转发至包含该服务的集群中。该集群中的 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机会相应地进行负载平衡，并处理该请求。</p></div><div class="section1" id="ESRI_SECTION1_C7F80C1007D54987BF3840B98E882D73" purpose="section1"><h2>数据</h2><p id="GUID-94BC57DE-FF98-4D4A-9413-76864F40BAF0"> 如在其他部署方案中所述，在使用基于文件的数据时，强烈建议您将本地资源用于 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机。这样虽会迫使您将数据复制到所有 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>，但却可降低网络流量，最终实现服务的较高性能。您应对此选择加以考虑并在适用时予以使用。如果将数据保存在所有计算机本地是一种实用的方法，则通常需要指定数据的大小和更新频率。</p><p id="GUID-9A8C2A8C-9556-418C-82CF-50DE0DA17ABA"> 如果在此部署模式中使用数据库，则始终使用专用硬件十分重要。保持数据库层独立于 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 层。</p></div><div class="section1" id="ESRI_SECTION1_A17AE34D1AE247CBA500E675632500D9" purpose="section1"><h2>Web Adaptor</h2><p id="GUID-7B8EADD6-0069-4F41-8C1A-D6C307FADF84"> 在此配置中，<span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 客户端从不直接连接 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 相反，可通过 Web Adaptor 连接它们，Web Adaptor 可提供安全功能并让整个站点具有更高的故障应对能力。</p><p id="GUID-0CAB3CA5-A75E-46C9-A5A1-CB507DD730D9">从安全性角度考虑，不推荐您访问相同的通道来使用和管理您的站点。通常，只能通过网络部分或可直接访问 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 的特定计算机执行管理任务，如通过 6080 或 6443 端口。可通过指定仅允许特定的 IP 地址访问管理员目录中的服务来克服上述问题。这由服务器的<a class="xref" target="_blank" rel="http://resources.arcgis.com/zh-cn/help/arcgis-rest-api/02r3/02r3000001t9000000.htm" href="http://resources.arcgis.com/zh-cn/help/arcgis-rest-api/02r3/02r3000001t9000000.htm">安全配置</a>中的 <span class="usertext">allowedAdminAccessIPs</span> 属性进行控制。要了解如何配置该属性以限制到服务器的访问，请参阅<a class="xref" target="_blank" rel="http://resources.arcgis.com/zh-cn/help/arcgis-rest-api/02r3/02r3000001rw000000.htm" href="http://resources.arcgis.com/zh-cn/help/arcgis-rest-api/02r3/02r3000001rw000000.htm">更新安全性配置</a>中的示例。</p><p id="GUID-601E6805-D64B-49FD-B341-95C745E65B85">来自客户端应用程序的请求始终通过 <span purpose="ph" translate="no" varid="WebAdaptorforArcGIS">ArcGIS Web Adaptor</span>（可配置为阻止使用任何管理端点）汇集。有关如何执行此操作的详细信息，请参阅<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/server/latest/administer/windows/configure-arcgis-web-adaptor-after-installation.htm" href="http://server.arcgis.com/zh-cn/server/latest/administer/windows/configure-arcgis-web-adaptor-after-installation.htm">安装后配置 ArcGIS Web Adaptor</a>。</p><p id="GUID-496C6DF8-01F3-4F5A-AD5E-E5738E2EC12A"><span purpose="ph" translate="no" varid="WebAdaptorforArcGIS">ArcGIS Web Adaptor</span> 还提供方式，可将 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 与组织中使用的标准验证方法相集成。它是一个小组件，可将其安装在自己的 web 服务器中作为 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 的反向代理。有关所支持的 web 服务器的列表，请参阅 <a class="xref" rel="01n1/01n100000034000000.htm" href="01n1/01n100000034000000.htm">ArcGIS Web Adaptor 系统要求</a>。通过配置 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 安全性来使用 web 层身份验证（相对于 GIS 层身份验证），<span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 将身份验证委托给您自己的 web 服务器。</p><p id="GUID-9644EFAC-A720-430A-8030-A706250F81D9">您的站点可配置多个 web adaptor 以支持多种身份验证方法。有关详细信息，请参阅<a class="xref" target="_blank" rel="http://server.arcgis.com/zh-cn/server/latest/administer/windows/supporting-a-mix-of-public-and-private-services.htm" href="http://server.arcgis.com/zh-cn/server/latest/administer/windows/supporting-a-mix-of-public-and-private-services.htm">支持公共服务和私有服务混合使用</a>。</p><p id="GUID-F33529F9-1C9D-44E5-A321-6B25D384E8BC"><span purpose="ph" translate="no" varid="WebAdaptorforArcGIS">ArcGIS Web Adaptor</span> 还可用作站点的负载平衡器。<span purpose="ph" translate="no" varid="WebAdaptorforArcGIS">ArcGIS Web Adaptor</span> 将根据轮询负载平衡算法将请求转发至 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 池。<span purpose="ph" translate="no" varid="WebAdaptorforArcGIS">ArcGIS Web Adaptor</span> 还将自动检测请求并将其转发至任何新添加到站点的 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span>，或者将停止向不可用或从站点中删除的计算机转发请求。</p></div><div class="section1" id="ESRI_SECTION1_343DCCE07E654E70A6E008C7ED2A06B9" purpose="section1"><h2>高可用性注意事项</h2><p id="GUID-998AC748-0092-4EEE-B685-03413A6E1872"> 该部署方案的高可用性变式将在下图所示的 Web Adaptor 层添加冗余。在配置您站点的多个 Web Adaptor 时，每个 Web Adaptor 将以轮询的方式将请求转发至站点中的所有 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机。</p><div class="image" purpose="image"><table><tr><td><img class="break" src="01n1/GUID-EC903B01-4355-4D5E-B61E-A3E9F8C4680F-web.png" purpose="img" alt="Web Adaptor 层上具有冗余的多机站点" title="Web Adaptor 层上具有冗余的多机站点"></td></tr><tr><td><div class="caption" purpose="caption">Web Adaptor 层上具有冗余的多机站点。每个 Web Adaptor 将以轮询的方式将请求转发至站点中的计算机。</div></td></tr></table></div><p id="GUID-3C9C0129-546C-4DFF-9E69-75768E29042B"> 应对上述注意事项加以考虑，从而消除数据、配置存储和服务器目录的单点故障。</p><p id="GUID-6E4A965E-EDA1-42FC-BE08-8072B3707092"> 在所有 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 上复制基于文件的数据集可对您有所帮助，然而，由于文件或大小的频繁改变，这个方法也未必始终可行。如果基于文件的数据集使用网络共享位置，请确保配置您的存储以实现高可用性。</p><p id="GUID-FBF7DE41-1102-4295-97A3-37E561C2979E"> 受 ArcGIS 支持的数据库还支持不同级别的高可用性配置。请参考聚集数据库层的数据库配置。</p><p id="GUID-1E454F1D-E20C-4422-9389-8E52D4856C6A"> 在此部署方案中，您的配置存储和服务器目录必须始终存储在网络共享位置。如果需要高可用性配置，请确保已对该层进行相应的设置。</p></div><div class="section1" id="ESRI_SECTION1_7D80FDD6984A4CB89673169EC202AE9B" purpose="section1"><h2>优点</h2><ul purpose="ul" id="UL_95A679B9F76D4BF689C7D662788FF04D"><li purpose="li" id="LI_282DE4C9AD6B4A4988654E435162F3EB">单个 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 站点可提供在多个计算机之间轻松管理 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 及其服务的方法。</li><li purpose="li" id="LI_27251CF49540483AB4F13EA8C01AE620"> 通过添加或移除 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 计算机来轻松调整站点的能力。</li><li purpose="li" id="LI_771CF22F97D84BABBF6A2695DEBED2F2">在多台 <span purpose="ph" translate="no" varid="ArcGISforServer">ArcGIS Server</span> 之间进行负载平衡。</li><li purpose="li" id="LI_B221E6281A344C07B9F5EB30C145FBA4">通过 <span purpose="ph" translate="no" varid="WebAdaptorforArcGIS">ArcGIS Web Adaptor</span> 使用 web 层身份验证来集成标准组织身份验证。</li></ul></div>
<div class="section1" id="ESRI_SECTION1_41EFAD1B165B4AD7BB2360CACBFE3F46" purpose="section1"><h2>缺点</h2><ul purpose="ul" id="UL_374A7525DA254583BD93C34CA24E3731"><li purpose="li" id="LI_D61CAD7C8A24463CAD02FB86848594B9">使用共享网络位置的服务器目录和数据可降低高负载下的服务性能。</li></ul></div>
<div class="footer"> Copyright © 1995-2017 Esri. All rights reserved. </div></div></body></html>