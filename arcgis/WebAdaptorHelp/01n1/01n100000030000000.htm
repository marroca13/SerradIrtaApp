<html lang="en" xml:lang="en"><head>
<META http-equiv="Content-Type" content="text/html">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><META name="description" content="A site can include multiple ArcGIS Server machines to handle increased traffic or provide a backup in case one of the machines goes offline."><meta name="content-language" content="en"><link href="rsrc/htmlhelp.css" rel="stylesheet" type="text/css"><title>ArcGIS - 
Multiple-machine deployment with third party load balancer</title>
                <script type="text/javascript" language="JavaScript">
                    var pathL  = self.location.pathname.split ("/");
                    var fname = pathL[pathL.length-1];
                    var i = fname.lastIndexOf (".htm");
                    if (i>=0) {
                    fname = fname.substring (0, i)
                    } else {
                    //??
                    }
                    if (self.location.hash) {
				    		      fname = fname + self.location.hash;
						        }
                    self.location.replace ("../index.html#//" + fname);
                </script>
                </head><!--Publication GUID: [GUID-FB5257BE-DC53-48C6-82F8-1DA075B0A617]--><!--Topic GUID: [GUID-08196164-3CAB-4F08-9C3E-C5BC43FF8C23]--><body><div id="content"><div class="header"><h1>
Multiple-machine deployment with third party load balancer</h1><div id="breadcrumb"></div></div>



<p id="GUID-7D1F5381-6018-4B2E-A173-E6FB8DB627C3"> <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> supports the configuration of multiple-machine sites. In a multiple-machine site, two or more servers can be administered and used as a single logical unit, providing <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span>  administrators with great flexibility to easily adjust the computing power of the site by adding or removing machines. Multiple-machine sites also simplify the process of publishing and updating services across multiple <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> machines.</p><p id="GUID-FA3F35BB-BE81-4D99-8507-6ED393B11F72">In a multiple-machine deployment, each <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> machine must be at the same version number for the site to function correctly.  Additionally, the exact same license must be applied to each machine that participates in  the site.</p><p id="GUID-7AA1BAD4-6DA4-4960-BFE4-38FCDA2633B2"> A common multiple-machine configuration involves a third-party reverse proxy server or network load-balancer sitting in front of a pool of <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> machines.</p><div class="image" purpose="image"><table><tr><td><img class="break" src="01n1/GUID-D4C995D9-D217-43B5-8405-C6865551E641-web.png" purpose="img" alt="Site with multiple" title="Site with multiple"></td></tr><tr><td><div class="caption" purpose="caption">Site with multiple <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> machines and a load-balancer</div></td></tr></table></div><p id="GUID-7813AE69-5DA1-4ABF-B26A-8430294C93FD"> A key aspect of multiple-machine configurations is that all <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> machines share the same configuration store and server directories. In this manner, an administrator can log in to any machine using <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span>  Manager and apply changes that will affect all machines within the site.</p><div class="section1" id="ESRI_SECTION1_14CC6AE269D74871B7D81EC84AB5DF75" purpose="section1"><h2><span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> machines, server directories, and configuration store</h2><p id="GUID-33B1D0C7-B9C5-44FB-A84C-3F395C5C1167">Because all <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> machines in multiple-machine configurations share the same configuration store and server directories, you must select a network location for your server directories and configuration store.</p><p id="GUID-7AE3C15F-3E83-4E7A-B412-95BBB3274DE7"> Typically, a domain account is chosen for the <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span>  account because this simplifies the management of data access permissions to network resources. However, depending on your own security policies, you may choose to use local accounts. The <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span>  account (local or domain) needs to have write access to the network share where the configuration store and server directories are located.  For more information, see <a class="xref" target="_blank" rel="http://server.arcgis.com/en/server/latest/administer/windows/accounts-used-by-arcgis-server.htm" href="http://server.arcgis.com/en/server/latest/administer/windows/accounts-used-by-arcgis-server.htm">Accounts used by ArcGIS Server</a>.</p><p id="GUID-93BA97C6-C3B8-40B1-B630-D7515B596705">In a multiple-machine site, all
<span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span>  machines initially belong to a single <a class="xref" target="_blank" rel="http://server.arcgis.com/en/server/latest/administer/windows/about-gis-server-clusters.htm" href="http://server.arcgis.com/en/server/latest/administer/windows/about-gis-server-clusters.htm">cluster</a> using ports 4004 and above. As of 10.4, <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> defaults to <a class="xref" target="_blank" rel="http://server.arcgis.com/en/server/latest/administer/windows/about-single-cluster-mode.htm" href="http://server.arcgis.com/en/server/latest/administer/windows/about-single-cluster-mode.htm">single cluster mode</a> for new installations. This mode does not include load balancing between machines in the cluster. This reduces network traffic between machines in the site, reduces load on your network, and helps improve  monitoring of <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> machines in your site. When upgrading to 10.4 or later from earlier releases, the mode will be enabled for sites with a single cluster that are not currently using single cluster mode. Single cluster sites already using single cluster mode and sites with multiple clusters at earlier releases will have their settings preserved when upgrading.</p><p id="GUID-91E9E50C-6209-4D73-8EBD-86870C1C743A"> If your site uses more than one cluster,
load-balancing is handled among all <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> machines within each
cluster. Essentially, clusters are independent groups of machines that run dedicated sets of services.</p><p id="GUID-34659E5E-FAAD-4401-9537-A5F1AC6E06A5">For example, an
incoming request is assigned to an available <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> machine in the
cluster, even if the request was directed to a specific machine
within or outside of the cluster. That machine then does the
work of drawing the map, finding the address coordinate, running
the geoprocessing tool, and so on, and returns the result to the
client. If a machine is offline or the service that was requested
is running in a different cluster, the request is forwarded to the
cluster containing the service. The <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span>  machines in that
cluster load-balance and process the request accordingly.</p></div><div class="section1" id="ESRI_SECTION1_68CB0DD2AAD84B5797E32AD99C6F8A19" purpose="section1"><h2>Data</h2><p id="GUID-683DCBD4-1E50-44E4-BE33-D0952AA667B5"> As described in other deployment scenarios, when using file-based data, it is highly
recommended to use local resources to the <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> machine. This
has the disadvantage of forcing you to duplicate your data across
all machines, but reduces network traffic and results in
higher performance for your services. You should consider this
option and use it when it is applicable. The size of your data and
the frequency of updates often dictate if keeping your data
local across all machines is a practical approach.</p><p id="GUID-C00F3955-D0D0-4E89-BF84-6AEFAC472A15"> When using databases in this
deployment pattern, it is important that you always use dedicated
hardware. Keep the database tier independent from the <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> tier.</p></div><div class="section1" id="ESRI_SECTION1_C0B4AA3B947E494CAF38E2D06896D1C7" purpose="section1"><h2>Third-party reverse proxy server or network load-balancer</h2><p id="GUID-59009666-37AB-4677-8DA2-E984B444C86F"> In this configuration, <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> clients never connect directly to your <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> machines. Instead, they connect through a middle tier that provides security features and makes your overall site more resilient to failures.</p><p id="GUID-0E9F0A14-AFE9-4891-9680-43EED7082B90"> From a security perspective, it is not a recommended practice to access the same channel to use and administer your site. Typically, administrative tasks are only enabled through sections of your network or specific machines that can access your <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> machines directly, for example, over port 6080 or 6443. You can overcome this by specifying that only certain IP addresses can access the server  in the Administrator Directory.  This is controlled by the <span class="usertext">allowedAdminAccessIPs</span> property in the server's <a class="xref" target="_blank" rel="http://resources.arcgis.com/en/help/arcgis-rest-api/02r3/02r3000001t9000000.htm" href="http://resources.arcgis.com/en/help/arcgis-rest-api/02r3/02r3000001t9000000.htm">security configuration</a>.  To learn how to configure this property to limit access to the server, see the example in   <a class="xref" target="_blank" rel="http://resources.arcgis.com/en/help/arcgis-rest-api/02r3/02r3000001rw000000.htm" href="http://resources.arcgis.com/en/help/arcgis-rest-api/02r3/02r3000001rw000000.htm">Update security configuration</a>.</p><p id="GUID-4D28AF6E-A555-4822-8C1B-D7DF5D01FF34"> Requests from client applications are always funneled through the reverse proxy, which prevents the use of any administrative end points. Most third-party proxies allow you to filter incoming requests that include a particular URL pattern. Blocking incoming requests using resources under the <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span>  Administrator Directory (<span class="usertext">http://gisserver.domain.com:6080/arcgis/admin</span>) or <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span>  Manager (<span class="usertext">http://gisserver.domain.com:6080/arcgis/manager</span>) effectively block any administrative tasks through your reverse proxy.</p><p id="GUID-6DC6A4F1-EF76-410B-A352-EBDFE31293F0"> Your reverse proxy also serves as a load balancer for the site. A simple load-balancing algorithm such as round-robin is adequate for this configuration.</p><p id="GUID-B9492F73-C386-4405-A524-9A134106B74D">If your network load balancer supports a health check function, you can use <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span>'s heath check endpoint to determine if the site is available to receive requests.  This is useful to quickly determine if there's a  software or hardware failure in the site.  For more information, see <a class="xref" target="_blank" rel="http://resources.arcgis.com/en/help/arcgis-rest-api/02r3/02r3000002n7000000.htm" href="http://resources.arcgis.com/en/help/arcgis-rest-api/02r3/02r3000002n7000000.htm">Health Check</a> in the ArcGIS REST API.</p><p id="GUID-28E2F286-E703-4DAA-95BA-016946315B13">To learn how to integrate a reverse proxy server with <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span>, see <a class="xref" target="_blank" rel="http://server.arcgis.com/en/server/latest/administer/windows/using-a-reverse-proxy-server-with-arcgis-server.htm" href="http://server.arcgis.com/en/server/latest/administer/windows/using-a-reverse-proxy-server-with-arcgis-server.htm">Using a reverse proxy server with ArcGIS Server</a>.</p></div><div class="section1" id="ESRI_SECTION1_7D80FDD6984A4CB89673169EC202AE9B" purpose="section1"><h2>Advantages</h2><ul purpose="ul" id="UL_95A679B9F76D4BF689C7D662788FF04D"><li purpose="li" id="LI_282DE4C9AD6B4A4988654E435162F3EB">A single <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span>  site provides the means to easily administer <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span>  and its services across a number of machines.</li><li purpose="li" id="LI_27251CF49540483AB4F13EA8C01AE620"> Easy to adjust the capacity of your site by adding and removing <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span>  machines.</li><li purpose="li" id="LI_771CF22F97D84BABBF6A2695DEBED2F2">Load balancing is handled among <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span> machines.</li></ul></div>
<div class="section1" id="ESRI_SECTION1_41EFAD1B165B4AD7BB2360CACBFE3F46" purpose="section1"><h2>Disadvantages</h2><ul purpose="ul" id="UL_990D447AD1774E3BB15F91EC33862342"><li purpose="li" id="LI_A1774AA02A234F6B99B66A5C3C260121">Use of <span purpose="ph" varid="ArcGISforServer" translate="no">ArcGIS Server</span>  directories and data in shared network locations can
negatively affect performance of services under heavy
load.</li><li purpose="li" id="LI_8E200906EA23425EAD7C18CEB73610F3">Requires
understanding of third party load balancers.</li><li purpose="li" id="LI_6F2309574D9A4365BB40ED27E5601F24">Does not
support web tier authentication. Refer to <a class="xref" rel="01n1/01n10000002t000000.htm" href="01n1/01n10000002t000000.htm">Multiple machine deployment with ArcGIS Web Adaptor</a> to leverage web tier authentication.</li></ul></div><div class="footer"> Copyright © 1995-2017 Esri. All rights reserved. </div></div></body></html>